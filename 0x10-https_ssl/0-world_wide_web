#!/bin/bash

# Function to display information about a subdomain
display_info() {
    local subdomain="$1"
    local domain="$2"
    local record_type="$3"
    local destination="$4"

    echo "The subdomain $subdomain is a $record_type record and points to $destination"
}

# Function to perform DNS lookup and extract information
get_dns_info() {
    local subdomain="$1"
    local domain="$2"
    local record_type="$3"

    # Perform DNS lookup and extract relevant information
    local result=$(dig "$subdomain.$domain" | awk -v record_type="$record_type" '
        /ANSWER SECTION:/ {
            getline; getline;
            print $4
        }
    ')

    echo "$result"
}

# Main script
main() {
    local domain="$1"
    local subdomain="$2"

    # List of subdomains to audit
    local subdomains=("www" "lb-01" "web-01" "web-02")

    # Check if a specific subdomain is provided
    if [ -n "$subdomain" ]; then
        record_type=$(get_dns_info "$subdomain" "$domain" "A")
        display_info "$subdomain" "$domain" "$record_type"
    else
        # Loop through the predefined subdomains and display information
        for sub in "${subdomains[@]}"; do
            record_type=$(get_dns_info "$sub" "$domain" "A")
            display_info "$sub" "$domain" "$record_type"
        done
    fi
}

# Check if the correct number of arguments is provided
if [ "$#" -lt 1 ] || [ "$#" -gt 2 ]; then
    echo "Usage: $0 <domain> [subdomain]"
    exit 1
fi

main "$1" "$2"

